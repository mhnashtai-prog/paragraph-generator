<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>INTUITY - Paragraph Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'DM Sans', 'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: #0B0B0B;
      color: #BFC3B8;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      min-height: 100vh;
      position: relative;
    }

    /* Animated Background */
    .background {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at 25% 15%, rgba(201, 169, 97, 0.09) 0%, transparent 50%),
                  radial-gradient(circle at 75% 85%, rgba(182, 95, 54, 0.07) 0%, transparent 45%),
                  radial-gradient(circle at 50% 50%, rgba(201, 169, 97, 0.04) 0%, transparent 60%),
                  #0B0B0B;
      z-index: 0;
      overflow: hidden;
    }

    .elegant-curves {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
    }

    .curve-elegant {
      position: absolute;
      border-radius: 50%;
      filter: blur(1.5px);
    }

    .curve-elegant-1 {
      width: 400px;
      height: 700px;
      top: -250px;
      right: -120px;
      border: 1.5px solid rgba(201, 169, 97, 0.16);
      background: linear-gradient(135deg, 
        rgba(201, 169, 97, 0.07) 0%, 
        rgba(201, 169, 97, 0.04) 50%, 
        transparent 100%);
      transform: rotate(30deg);
      animation: floatElegant 14s ease-in-out infinite;
    }

    .curve-elegant-2 {
      width: 500px;
      height: 900px;
      bottom: -350px;
      left: -180px;
      border: 1px solid rgba(182, 95, 54, 0.14);
      background: linear-gradient(135deg, 
        rgba(182, 95, 54, 0.06) 0%, 
        transparent 65%);
      transform: rotate(-25deg);
      animation: floatElegant 17s ease-in-out infinite reverse;
    }

    .curve-elegant-3 {
      width: 300px;
      height: 600px;
      top: 35%;
      right: 8%;
      border: 1px solid rgba(201, 169, 97, 0.12);
      background: linear-gradient(135deg, 
        rgba(201, 169, 97, 0.05) 0%, 
        transparent 75%);
      transform: rotate(50deg);
      animation: driftElegant 20s ease-in-out infinite;
    }

    @keyframes floatElegant {
      0%, 100% { 
        transform: translateY(0) rotate(var(--base-rotation, 0deg));
        opacity: 1;
      }
      50% { 
        transform: translateY(-25px) rotate(calc(var(--base-rotation, 0deg) + 3deg));
        opacity: 0.65;
      }
    }

    @keyframes driftElegant {
      0%, 100% { 
        transform: translate(0, 0) rotate(50deg);
      }
      33% { 
        transform: translate(15px, -20px) rotate(53deg);
      }
      66% { 
        transform: translate(-8px, -12px) rotate(47deg);
      }
    }

    .curve-elegant-1 { --base-rotation: 30deg; }
    .curve-elegant-2 { --base-rotation: -25deg; }

    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' /%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.015'/%3E%3C/svg%3E");
      pointer-events: none;
      z-index: 1;
    }

    .container { 
      max-width: 1280px; 
      margin: 0 auto; 
      position: relative;
      z-index: 2;
      padding: 0 1.5rem;
    }

    /* Header */
    .header { 
      display: grid;
      grid-template-columns: 120px 1fr 120px;
      align-items: center;
      margin-bottom: 1.5rem;
      padding: 1rem 1.5rem 0.75rem;
    }

    .header-left {
      justify-self: start;
    }

    .header-center {
      text-align: center;
    }

    .header-right {
      /* Empty spacer */
    }

    .header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem; 
      font-weight: 700; 
      color: #C9A961;
      margin: 0; 
      letter-spacing: 0.02em;
      background: linear-gradient(135deg, #C9A961 0%, rgba(201, 169, 97, 0.75) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header .subtitle { 
      font-size: 0.875rem; 
      color: #8e8e93; 
      margin: 0.375rem 0 0.25rem; 
      font-weight: 500;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-family: 'DM Sans', sans-serif;
    }

    .header .author { 
      font-size: 0.75rem; 
      color: #B65F36; 
      font-weight: 400;
      letter-spacing: 0.02em;
      margin: 0;
      font-style: italic;
    }

    .back-btn {
      background: rgba(28, 28, 30, 0.5);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      border: 1px solid rgba(201, 169, 97, 0.2);
      color: #C9A961;
      padding: 0.5rem 1rem;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      border-radius: 0.75rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: 'DM Sans', sans-serif;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
      position: relative;
      overflow: hidden;
    }

    .back-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(201, 169, 97, 0.15), transparent);
      transition: left 0.5s;
    }

    .back-btn:hover::before {
      left: 100%;
    }

    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(201, 169, 97, 0.25);
      border-color: rgba(201, 169, 97, 0.4);
    }

    /* Level Selection Bar */
    .level-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 2rem;
      padding: 0 1.5rem;
    }

    .level-group {
      display: flex;
      background: rgba(28, 28, 30, 0.6);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      border-radius: 0.75rem;
      padding: 0.375rem;
      border: 1px solid rgba(84, 84, 88, 0.25);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.35);
      gap: 0.375rem;
    }

    .level-btn {
      background: transparent;
      border: none;
      color: #8e8e93;
      padding: 0.5rem 1.25rem;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      border-radius: 0.625rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: 'DM Sans', sans-serif;
      position: relative;
      overflow: hidden;
    }

    .level-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(201, 169, 97, 0.15), transparent);
      transition: left 0.5s;
    }

    .level-btn:hover::before {
      left: 100%;
    }

    .level-btn:hover {
      color: #C9A961;
    }

    .level-btn.active {
      background: rgba(201, 169, 97, 0.25);
      color: #C9A961;
      box-shadow: 0 2px 12px rgba(201, 169, 97, 0.25);
      border: 1px solid rgba(201, 169, 97, 0.3);
    }

    /* Main Workspace */
    .workspace {
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: 2rem;
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1.5rem 3rem;
    }

    /* Sidebar with Expressions */
    .sidebar {
      background: rgba(28, 28, 30, 0.6);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      border-radius: 1.5rem;
      padding: 2rem;
      border: 1px solid rgba(84, 84, 88, 0.25);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      height: fit-content;
      max-height: calc(100vh - 280px);
      overflow-y: auto;
      position: sticky;
      top: 2rem;
    }

    .sidebar-header {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(84, 84, 88, 0.2);
    }

    .sidebar-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.125rem;
      font-weight: 600;
      color: #C9A961;
      letter-spacing: 0.02em;
      margin-bottom: 0.5rem;
    }

    .sidebar-subtitle {
      font-size: 0.75rem;
      color: #8e8e93;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 600;
    }

    .section-group {
      margin-bottom: 1.5rem;
    }

    .section-header {
      font-size: 0.6875rem;
      color: #B65F36;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 700;
      margin-bottom: 0.75rem;
      padding-left: 0.25rem;
    }

    .expression-item {
      background: rgba(13, 13, 13, 0.6);
      border: 1px solid rgba(84, 84, 88, 0.2);
      border-radius: 0.875rem;
      padding: 0.875rem 1rem;
      margin-bottom: 0.625rem;
      font-size: 0.75rem;
      line-height: 1.6;
      color: #e5e5e7;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .expression-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(201, 169, 97, 0.08), transparent);
      transition: left 0.6s;
    }

    .expression-item:hover::before {
      left: 100%;
    }

    .expression-item:hover {
      background: rgba(201, 169, 97, 0.12);
      border-color: rgba(201, 169, 97, 0.35);
      transform: translateX(6px);
      box-shadow: 0 4px 16px rgba(201, 169, 97, 0.15);
    }

    .placeholder {
      color: #636366;
      font-style: italic;
      text-align: center;
      padding: 2rem 1rem;
    }

    /* Writing Area */
    .writing-area-container {
      background: rgba(28, 28, 30, 0.6);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      border-radius: 1.5rem;
      padding: 2rem;
      border: 1px solid rgba(84, 84, 88, 0.25);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .writing-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(84, 84, 88, 0.2);
    }

    .writing-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.125rem;
      font-weight: 600;
      color: #C9A961;
      letter-spacing: 0.02em;
    }

    .word-count {
      font-size: 0.75rem;
      color: #8e8e93;
      font-weight: 600;
      background: rgba(13, 13, 13, 0.5);
      padding: 0.375rem 0.75rem;
      border-radius: 0.5rem;
      border: 1px solid rgba(84, 84, 88, 0.2);
    }

    textarea {
      width: 100%;
      min-height: 500px;
      background: rgba(13, 13, 13, 0.85);
      border: 1px solid rgba(84, 84, 88, 0.2);
      border-radius: 1.125rem;
      padding: 1.5rem;
      color: #e5e5e7;
      font-size: 0.9375rem;
      line-height: 1.85;
      font-family: 'DM Sans', sans-serif;
      resize: vertical;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    textarea:focus {
      outline: none;
      border-color: rgba(201, 169, 97, 0.5);
      background: rgba(13, 13, 13, 0.95);
      box-shadow: 0 0 0 4px rgba(201, 169, 97, 0.12);
    }

    textarea::placeholder {
      color: #636366;
      font-style: italic;
    }

    .action-buttons {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }

    .action-btn {
      background: rgba(28, 28, 30, 0.6);
      backdrop-filter: blur(40px) saturate(150%);
      -webkit-backdrop-filter: blur(40px) saturate(150%);
      border: 1px solid rgba(84, 84, 88, 0.25);
      color: #C9A961;
      padding: 0.5rem 1.25rem;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      border-radius: 0.75rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      font-family: 'DM Sans', sans-serif;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
      position: relative;
      overflow: hidden;
    }

    .action-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(201, 169, 97, 0.15), transparent);
      transition: left 0.5s;
    }

    .action-btn:hover::before {
      left: 100%;
    }

    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(201, 169, 97, 0.25);
      border-color: rgba(201, 169, 97, 0.4);
    }

    .primary-btn {
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.25), rgba(201, 169, 97, 0.15));
      border: 1px solid rgba(201, 169, 97, 0.5);
    }

    .primary-btn:hover {
      background: linear-gradient(135deg, rgba(201, 169, 97, 0.35), rgba(201, 169, 97, 0.25));
      box-shadow: 0 8px 32px rgba(201, 169, 97, 0.35);
    }

    /* Scrollbar Styling */
    .sidebar::-webkit-scrollbar,
    textarea::-webkit-scrollbar {
      width: 8px;
    }

    .sidebar::-webkit-scrollbar-track,
    textarea::-webkit-scrollbar-track {
      background: transparent;
    }

    .sidebar::-webkit-scrollbar-thumb,
    textarea::-webkit-scrollbar-thumb {
      background: rgba(201, 169, 97, 0.3);
      border-radius: 8px;
      transition: background 0.2s ease;
    }

    .sidebar::-webkit-scrollbar-thumb:hover,
    textarea::-webkit-scrollbar-thumb:hover {
      background: rgba(201, 169, 97, 0.5);
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .workspace {
        grid-template-columns: 1fr;
      }

      .sidebar {
        position: static;
        max-height: 450px;
      }

      .header {
        grid-template-columns: auto 1fr auto;
      }
    }

    @media (max-width: 640px) {
      .header h1 {
        font-size: 2rem;
      }

      .level-btn {
        padding: 0.4rem 1rem;
        font-size: 0.6875rem;
      }

      .action-btn {
        padding: 0.4rem 1rem;
        font-size: 0.6875rem;
      }

      textarea {
        min-height: 400px;
        font-size: 0.875rem;
      }
    }
  </style>
</head>
<body>
  <div class="background">
    <div class="elegant-curves">
      <div class="curve-elegant curve-elegant-1"></div>
      <div class="curve-elegant curve-elegant-2"></div>
      <div class="curve-elegant curve-elegant-3"></div>
    </div>
  </div>

  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <button class="back-btn" onclick="window.location.href='index.html'">‚Üê Back</button>
      </div>
      <div class="header-center">
        <h1>INTUITY</h1>
        <p class="subtitle">Paragraph Generator</p>
        <p class="author">Majid Nashtai</p>
      </div>
      <div class="header-right"></div>
    </div>

    <!-- Level Selection Bar -->
    <div class="level-bar">
      <div class="level-group">
        <button class="level-btn active" onclick="switchLevel('B2')">B2</button>
        <button class="level-btn" onclick="switchLevel('C1')">C1</button>
        <button class="level-btn" onclick="switchLevel('C2')">C2</button>
      </div>
    </div>

    <!-- Main Workspace -->
    <div class="workspace">
      <!-- Sidebar with Expressions -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="sidebar-title">Curated Expressions</div>
          <div class="sidebar-subtitle" id="sidebarSubtitle">B2 Level ‚Ä¢ Click to Insert</div>
        </div>
        <div id="expressionsList">
          <p class="placeholder">Loading expressions...</p>
        </div>
      </aside>

      <!-- Writing Area -->
      <div class="writing-area-container">
        <div class="writing-header">
          <div class="writing-title">Your Paragraph</div>
          <div class="word-count" id="wordCount">0 words</div>
        </div>
        <textarea 
          id="writingArea" 
          placeholder="Begin crafting your paragraph here... Click any expression from the sidebar to elegantly insert it at your cursor position."
          spellcheck="true"
        ></textarea>
        <div class="action-buttons">
          <button class="action-btn" onclick="clearText()">Clear All</button>
          <button class="action-btn primary-btn" onclick="saveText()">üíæ Save Document</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentLevel = 'B2';
    let expressionData = {};

    // Load expressions from JSON file
    async function loadExpressions(level) {
      try {
        const response = await fetch(`../../samples/advanced-structures.json`);
        if (!response.ok) {
          throw new Error(`Failed to load ${level} expressions`);
        }
        const data = await response.json();
        expressionData[level] = data;
        displayExpressions(data);
      } catch (error) {
        console.error('Error loading expressions:', error);
        document.getElementById('expressionsList').innerHTML = 
          '<p class="placeholder">Unable to load expressions. Please check that the JSON files exist in the phrases/ directory.</p>';
      }
    }

    // Display expressions in sidebar
    function displayExpressions(data) {
      const expressionsList = document.getElementById('expressionsList');
      expressionsList.innerHTML = '';

      if (!data || Object.keys(data).length === 0) {
        expressionsList.innerHTML = '<p class="placeholder">No expressions available for this level.</p>';
        return;
      }

      // Iterate through sections (e.g., introduction, main, atmosphere, etc.)
      for (const [section, expressions] of Object.entries(data)) {
        const sectionGroup = document.createElement('div');
        sectionGroup.className = 'section-group';

        const sectionHeader = document.createElement('div');
        sectionHeader.className = 'section-header';
        sectionHeader.textContent = section.charAt(0).toUpperCase() + section.slice(1);
        sectionGroup.appendChild(sectionHeader);

        // Handle nested structure or flat array
        if (Array.isArray(expressions)) {
          expressions.forEach(expr => {
            const item = createExpressionItem(expr);
            sectionGroup.appendChild(item);
          });
        } else if (typeof expressions === 'object') {
          // If it's an object with subsections
          for (const [subsection, items] of Object.entries(expressions)) {
            if (Array.isArray(items)) {
              items.forEach(expr => {
                const item = createExpressionItem(expr);
                sectionGroup.appendChild(item);
              });
            }
          }
        }

        expressionsList.appendChild(sectionGroup);
      }
    }

    // Create expression item element
    function createExpressionItem(text) {
      const item = document.createElement('div');
      item.className = 'expression-item';
      item.textContent = text;
      item.onclick = () => insertExpression(text);
      return item;
    }

    // Switch level
    function switchLevel(level) {
      currentLevel = level;

      // Update button states
      document.querySelectorAll('.level-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');

      // Update subtitle
      document.getElementById('sidebarSubtitle').textContent = `${level} Level ‚Ä¢ Click to Insert`;

      // Load expressions for this level
      if (expressionData[level]) {
        displayExpressions(expressionData[level]);
      } else {
        loadExpressions(level);
      }
    }

    // Insert expression into textarea
    function insertExpression(text) {
      const textarea = document.getElementById('writingArea');
      const start = textarea.selectionStart;
      const end = textarea.selectionEnd;
      const before = textarea.value.substring(0, start);
      const after = textarea.value.substring(end);

      const needsSpaceBefore = before.length > 0 && !before.endsWith(' ') && !before.endsWith('\n');
      const prefix = needsSpaceBefore ? ' ' : '';

      textarea.value = before + prefix + text + ' ' + after;

      const newPos = start + prefix.length + text.length + 1;
      textarea.setSelectionRange(newPos, newPos);
      textarea.focus();

      updateWordCount();
    }

    // Update word count
    function updateWordCount() {
      const textarea = document.getElementById('writingArea');
      const text = textarea.value.trim();
      const words = text ? text.split(/\s+/).length : 0;
      document.getElementById('wordCount').textContent = `${words} word${words !== 1 ? 's' : ''}`;
    }

    // Clear text
    function clearText() {
      if (confirm('Are you sure you want to clear all text?')) {
        document.getElementById('writingArea').value = '';
        updateWordCount();
      }
    }

    // Save text
    function saveText() {
      const text = document.getElementById('writingArea').value;
      const blob = new Blob([text], { type: 'text/plain' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `INTUITY_${currentLevel}_Paragraph_${new Date().toISOString().split('T')[0]}.txt`;
      link.click();

      const btn = event.target;
      const original = btn.innerHTML;
      btn.innerHTML = '‚úì Saved!';
      btn.style.background = 'rgba(201, 169, 97, 0.35)';
      setTimeout(() => {
        btn.innerHTML = original;
        btn.style.background = '';
      }, 1500);
    }

    // Event listeners
    document.getElementById('writingArea').addEventListener('input', updateWordCount);

    // Initialize - load B2 on page load
    loadExpressions('B2');
  </script>
</body>
</html>
